<?php
include('header.php');

?>

    <style>
        .m-form.m-form--group-seperator-dashed .m-form__group {
            border-bottom: 0px dashed #ebedf2;
        }
        .thh h3{
            background: #1F3958;
            color: #fff;
            font-weight: bold;
            font-size: 15px;
            text-transform: uppercase;
            padding: 10px 10px 10px 29px;
            -webkit-border-top-left-radius: 20px !important;
            -webkit-border-top-right-radius: 20px !important;
            -moz-border-radius-topleft: 20px !important;
            -moz-border-radius-topright: 20px !important;
            border-top-left-radius: 20px !important;
            border-top-right-radius: 20px !important;
            margin: 15px 15px 0 15px;
        }
        .in_fo{
            box-shadow: 0px 5px 10px 0px #cccccc !important;
            margin: 0 15px;
            padding-bottom: 20px;
            -webkit-border-bottom-right-radius: 20px;
            -webkit-border-bottom-left-radius: 20px;
            -moz-border-radius-bottomright: 20px;
            -moz-border-radius-bottomleft: 20px;
            border-bottom-right-radius: 20px;
            border-bottom-left-radius: 20px;
        }
        .m-form.m-form--group-seperator-dashed .m-form__group {
            border-bottom: 0px dashed #ebedf2;
            padding-bottom: 0;
            padding-top: 10px;
        }
        .m-portlet .m-form.m-form--fit > .m-portlet__body {
            padding-bottom: 40px !important;
        }
        .nav {
            display: -webkit-box;
        }
        .m-portlet {
            margin-bottom: 0;
        }
        .m-widget4 .m-widget4__item .m-widget4__info {
            width: 97.7%;
        }
		.setper {
    padding: 5px 2px;width: 100%;
}
.setper .sublab {
    margin-left: 5px;
}
.perlable {
    width: 11%;
}
    </style>
    <div class="m-grid__item m-grid__item--fluid m-wrapper">

        <!-- END: Subheader -->
        <div class="m-content">

            <!--begin::Portlet-->
            <div class="m-portlet lp-theme-card bg-transparent">
                <div class="m-portlet__head">
                    <div class="m-portlet__head-caption">
                        <div class="m-portlet__head-title">
                            <h3 class="m-portlet__head-text">
								Permission
                            </h3>
                        </div>
                        <div class="theme-new-nav-menu">
                            <a class="back-link" href="#">
<svg width="16" height="14" viewBox="0 0 16 14" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M7.70679 13.7006C7.51926 13.888 7.26495 13.9934 6.99979 13.9934C6.73462 13.9934 6.48031 13.888 6.29279 13.7006L0.292786 7.70057C0.105315 7.51304 0 7.25874 0 6.99357C0 6.72841 0.105315 6.4741 0.292786 6.28657L6.29279 0.286571C6.48139 0.104413 6.73399 0.00361876 6.99619 0.00589718C7.25838 0.0081756 7.5092 0.113345 7.6946 0.298753C7.88001 0.484161 7.98518 0.734973 7.98746 0.99717C7.98974 1.25937 7.88894 1.51197 7.70679 1.70057L3.41379 5.99357H14.9998C15.265 5.99357 15.5194 6.09893 15.7069 6.28646C15.8944 6.474 15.9998 6.72835 15.9998 6.99357C15.9998 7.25879 15.8944 7.51314 15.7069 7.70068C15.5194 7.88821 15.265 7.99357 14.9998 7.99357H3.41379L7.70679 12.2866C7.89426 12.4741 7.99957 12.7284 7.99957 12.9936C7.99957 13.2587 7.89426 13.513 7.70679 13.7006Z" fill="#333333"/>
</svg>
 Back</a>
                            <ul>
                                <li> <a href="http://lexport.demosbywpsqr.com/admin/action_log">Log Information</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/change_pass">Reset Password</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/services/services">E-Service Name</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/case_type">E-Service Type</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/task_type">Task Type</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/consultation_type">Consultation Type</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/writing_type">Writing Type</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/fine_type">Fine Type</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/add_group">Add Group</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/department_type">Department Type</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/employee_type">Employee Type</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/hr_eservice_type">HR E-Service Type</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/project_type">Project Type</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/list_judge">Judge</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/court_master">Court</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/branch">Branch List</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/city">Cities List</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/block_list">Block List</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/marketing_banner">Marketing Banner</a> </li>
								<li  class="active"> <a href="http://lexport.demosbywpsqr.com/admin/permission/add_permission">Permission</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/chat">Support Chat</a> </li>
								<li> <a href="http://lexport.demosbywpsqr.com/admin/admin/send_notification">Send Notification</a> </li>
                            </ul>

                        </div>
                    </div>
                </div>

                <!--begin::Form-->
<?php echo form_open_multipart('admin/permission/store_permission',['id'=>'permission','class'=>'m-form m-form--fit m-form--label-align-right m-form--group-seperator-dashed']); ?>
<div class="m-portlet__body theme-inner-form">
<div class="form-field-container">
<h3>Select User</h3>
<div class="form-group m-form__group row pp_col">
<div class="col-lg-12">
<select class="form-control" id="employee_id" name="user_id" required>
<option value="">Select employee </option>
<?php  foreach ($employees as $employee) {?>
<option value="<?php echo $employee['id']?>"><?php echo $employee['name']?></option>
<?php }?>	    
</select>
</div>
</div>
</div>

<div class="form-field-container">
    <div class="title-with-radio">
        <h3>Set Permission</h3>
        <div class="theme-radio-btn">
        <label for="ckbCheckAll"><input type="radio" name="chks" id="ckbCheckAll" /> Check All</label>
        <label for="unckbCheckAll"><input type="radio" name="chks" checked  id="unckbCheckAll" />  UnCheck All</label>
        </div>
    </div>

<div class="form-group m-form__group p-0">
<?php
			$count = count($permission);
			foreach ($permission as $pm) { ?>
			<div class="setper">
				<label for="clients" class="form-control-label perlable"><b><?php echo $pm['name'];?>:</b></label>
				<?php if($pm['id']==1) { ?>
				<input type="checkbox" value="1" id="1<?php echo $pm['id'];?>" class="sublab" name="pm[<?php echo $pm['id'];?>][]"> Assign 
				<input type="checkbox" value="2" id="2<?php echo $pm['id'];?>" class="sublab" name="pm[<?php echo $pm['id'];?>][]"> Edit
				<input type="checkbox" value="3" id="3<?php echo $pm['id'];?>" class="sublab" name="pm[<?php echo $pm['id'];?>][]"> View
				<input type="checkbox" value="4" id="4<?php echo $pm['id'];?>" class="sublab" name="pm[<?php echo $pm['id'];?>][]"> Add Mission 
				<input type="checkbox" value="5" id="5<?php echo $pm['id'];?>" class="sublab" name="pm[<?php echo $pm['id'];?>][]"> Delete
				<input type="checkbox" value="6" id="6<?php echo $pm['id'];?>" class="sublab" name="pm[<?php echo $pm['id'];?>][]"> Invoice
				<input type="checkbox" value="7" id="7<?php echo $pm['id'];?>" class="sublab" name="pm[<?php echo $pm['id'];?>][]"> Expense
				<?php } else { ?>
				
				
				<input type="checkbox" value="1" id="1<?php echo $pm['id'];?>" class="sublab" name="pm[<?php echo $pm['id'];?>][]"> Edit 
				<input type="checkbox" value="2" id="2<?php echo $pm['id'];?>" class="sublab" name="pm[<?php echo $pm['id'];?>][]"> Close
				<input type="checkbox" value="3" id="3<?php echo $pm['id'];?>" class="sublab" name="pm[<?php echo $pm['id'];?>][]"> View
				<input type="checkbox" value="4" id="4<?php echo $pm['id'];?>" class="sublab" name="pm[<?php echo $pm['id'];?>][]"> Convert 
				
				
				<?php } ?>
			</div>
		<?php } ?>

	</div> 
</div>
<div class="row">
<div class="col-lg-12">
			 <?php echo form_submit(['id'=>'add_permissions','value'=>'Submit','class'=>'btn btn-primary btn-lg']); ?>
			</div>
</div>
</div>
</form>

                <!--end::Form-->
            </div>

            <!--end::Portlet-->
        </div>
    </div>
<p id="msg"></p>
<?php include "footer.php";?>
<script type="text/javascript">
	
  	var url="<?= base_url('admin/permission/get_permission'); ?>"; 
	$('#employee_id').on('change',function(){
	    $(".sublab").prop('checked', false);
		var id=$(this).val();
		$.ajax({
		    type:'ajax',
		    method:'post',
		    url:url,
		    data:{"id" : id},
		    success:function(data){
			    var obj = $.parseJSON(data);   
					
				for(var i = 1; i < <?php echo $count; ?>+1; i++) {
				    var cube = obj[i];
				    	
				    for(var j = 1; j < 8; j++) {
				        var item = j+''+i;
				        if(cube[j] == 1){
				        	$("#" + item).prop('checked', true);
				        }
				    }
				}
		    },
		});
	})
	
$(document).ready(function () {
    $("#ckbCheckAll").click(function () {
            $(".sublab").prop('checked', true);
    });
	    $("#unckbCheckAll").click(function () {
       $(".sublab").prop('checked', false);
    });
});
</script>